<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>分頁架構預覽</title>
    <style>
        :root {
            --bg: #0f172a;
            --panel: #1e293b;
            --primary: #10b981;
            --accent: #f43f5e;
            --secondary: #fbbf24;
            --text: #f8fafc;
            --grid-bg: #111827;
            --dot-empty: #334155;
        }
        body {
            margin: 0; background: var(--bg); color: var(--text);
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            display: flex; flex-direction: column; height: 100vh; overflow: hidden;
            -webkit-user-select: none; user-select: none;
        }

        /* 頂部控制列 */
        .controls {
            padding: 15px; background: var(--panel);
            display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.4); z-index: 20;
        }
        .card { display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .label { font-size: 0.75rem; color: #94a3b8; margin-bottom: 5px; }
        .value-text { font-size: 2rem; font-weight: 800; color: var(--primary); line-height: 1; }
        
        .nav-tabs {
            grid-column: 1 / -1; display: flex; justify-content: center; gap: 10px; margin-top: 10px;
        }
        .tab-btn {
            background: #334155; border: none; color: #94a3b8; padding: 8px 20px;
            border-radius: 20px; cursor: pointer; font-size: 0.85rem; transition: 0.2s;
        }
        .tab-btn.active { background: var(--primary); color: white; }

        /* 中央內容區與分頁隱藏邏輯 */
        .main-content {
            flex-grow: 1; display: flex; flex-direction: column;
            align-items: center; justify-content: center; padding: 20px;
            position: relative;
        }
        .page {
            display: none; width: 100%; height: 100%;
            flex-direction: column; align-items: center; justify-content: center;
        }
        .page.active { display: flex; }

        /* 圖片預覽框 */
        .img-preview {
            width: 150px; height: 150px; border: 2px dashed #475569;
            border-radius: 20px; display: flex; align-items: center;
            justify-content: center; background-size: cover; background-position: center;
            margin-bottom: 20px; color: #475569;
        }

        /* 底部按鈕區 */
        .footer { padding: 30px; display: flex; flex-direction: column; align-items: center; gap: 15px; }
        .action-button {
            padding: 16px 60px; font-size: 1.25rem; font-weight: bold;
            border-radius: 50px; border: none; cursor: pointer;
            background: var(--primary); color: white; transition: all 0.2s;
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        }
        
        #fileInput { display: none; }
    </style>
</head>
<body>

    <div class="controls">
        <div class="nav-tabs">
            <button class="tab-btn active" onclick="switchPage('edit')">編輯頁面</button>
            <button class="tab-btn" onclick="switchPage('preview')">預覽頁面</button>
        </div>
        
        <div class="card">
            <span class="value-text" id="statusText">Ready</span>
            <span class="label">緩衝區狀態</span>
        </div>
    </div>

    <div class="main-content">
        <!-- 頁面 1：編輯/上傳 -->
        <div id="page-edit" class="page active">
            <div class="img-preview" id="edit-preview">無圖像</div>
            <input type="file" id="fileInput" accept="image/*">
            <button class="action-button" onclick="document.getElementById('fileInput').click()">上傳圖像到 Buffer</button>
        </div>

        <!-- 頁面 2：預覽/共享展示 -->
        <div id="page-preview" class="page">
            <div class="img-preview" id="shared-preview">無圖像</div>
            <p style="color:#94a3b8">此處圖像直接從全域 Buffer 讀取</p>
        </div>
    </div>

    <div class="footer">
        <div class="hint-text">
            切換頁面時，圖像數據保留在記憶體中不消失。
        </div>
    </div>

    <script>
        // --- 全域資產緩衝區 (Shared Asset Buffer) ---
        const appAssets = {
            imageBuffer: null // 這裡存儲 Base64 或 Blob URL
        };

        // 頁面切換邏輯
        function switchPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            
            document.getElementById('page-' + pageId).classList.add('active');
            event.target.classList.add('active');

            // 如果切換到預覽頁，更新顯示
            if (pageId === 'preview' && appAssets.imageBuffer) {
                document.getElementById('shared-preview').style.backgroundImage = `url(${appAssets.imageBuffer})`;
                document.getElementById('shared-preview').textContent = '';
            }
        }

        // 圖像上傳與 Buffer 寫入
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(event) {
                // 將數據存入共用 Buffer
                appAssets.imageBuffer = event.target.result;
                
                // 更新當前頁面 UI
                const editPreview = document.getElementById('edit-preview');
                editPreview.style.backgroundImage = `url(${appAssets.imageBuffer})`;
                editPreview.textContent = '';
                
                document.getElementById('statusText').textContent = "Loaded";
                document.getElementById('statusText').style.color = "var(--primary)";
            };
            reader.readAsDataURL(file);
        });
    </script>

</body>
</html>